<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human vs AI Trading Battle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a2040 50%, #2d3561 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 42px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: glow 3s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(255, 107, 107, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(78, 205, 196, 0.8)); }
        }

        .header p {
            opacity: 0.9;
            font-size: 20px;
            font-weight: 600;
        }

        .battle-status {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            margin-bottom: 30px;
            align-items: center;
        }

        .competitor {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
        }

        .competitor.winning {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0, 255, 135, 0.5);
            border: 2px solid #00ff87;
        }

        .competitor.losing {
            opacity: 0.7;
            border: 2px solid #ff6b6b;
        }

        .competitor-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .human-title {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .ai-title {
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .balance-display {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .pnl-display {
            font-size: 18px;
            font-weight: 600;
        }

        .vs-indicator {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            animation: pulse 2s infinite;
            margin: 0 auto;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 20px;
        }

        .chart-section {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pair-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 16px;
        }

        .current-price {
            font-size: 28px;
            font-weight: bold;
            color: #00ff87;
        }

        .price-change {
            font-size: 14px;
            margin-left: 10px;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .price-up { background: rgba(0, 255, 135, 0.2); color: #00ff87; }
        .price-down { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }

        .chart-container {
            height: 350px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .chart {
            height: 100%;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: flex-end;
            padding: 10px 0;
        }

        .candle {
            width: 6px;
            border-radius: 1px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            min-height: 3px;
            margin: 0 1px;
        }

        .candle:hover {
            transform: scaleX(1.5);
            z-index: 10;
        }

        .candle.green {
            background: linear-gradient(to top, #00cc6a, #00ff87);
            box-shadow: 0 2px 8px rgba(0, 255, 135, 0.3);
        }

        .candle.red {
            background: linear-gradient(to top, #ff5252, #ff6b6b);
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
        }

        .candle.news-event {
            animation: newsFlash 0.5s ease-in-out;
        }

        @keyframes newsFlash {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(2); }
        }

        .signal-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 20;
            animation: signalPulse 1.5s infinite;
        }

        @keyframes signalPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .signal-buy {
            background: linear-gradient(45deg, rgba(0, 255, 135, 0.9), rgba(0, 204, 106, 0.9));
            color: white;
        }

        .signal-sell {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.9), rgba(255, 82, 82, 0.9));
            color: white;
        }

        .trading-panel {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .panel-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #ff6b6b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-panel .panel-title {
            color: #4ecdc4;
        }

        .signals-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
        }

        .current-signal {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
        }

        .signal-type {
            font-weight: bold;
            font-size: 14px;
        }

        .signal-strength {
            font-size: 11px;
            opacity: 0.8;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
            font-size: 12px;
        }

        .form-input {
            width: 100%;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: #00ff87;
            box-shadow: 0 0 0 2px rgba(0, 255, 135, 0.2);
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-buy {
            background: linear-gradient(45deg, #00ff87, #00cc6a);
            color: white;
        }

        .btn-sell {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            color: white;
        }

        .positions {
            max-height: 180px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .position {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            font-size: 11px;
        }

        .position-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .close-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 10px;
            cursor: pointer;
        }

        .ai-status {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .ai-thinking {
            animation: thinking 2s infinite;
        }

        @keyframes thinking {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .profit { color: #00ff87; }
        .loss { color: #ff6b6b; }
        .neutral { color: #60efff; }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 14px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: rgba(0, 255, 135, 0.9);
            color: white;
        }

        .notification.error {
            background: rgba(255, 107, 107, 0.9);
            color: white;
        }

        .notification.ai {
            background: rgba(78, 205, 196, 0.9);
            color: white;
        }

        .battle-controls {
            text-align: center;
            margin: 20px 0;
        }

        .battle-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .battle-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .battle-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* New navigation buttons */
        .navigation-buttons {
            text-align: center;
            margin: 30px 0 20px 0;
        }

        .nav-btn {
            background: linear-gradient(45deg, #96ceb4, #feca57);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
            text-decoration: none;
            display: inline-block;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #84b8a0, #fbb342);
        }

        .nav-btn:visited {
            color: white;
        }

        .disclaimer {
            margin-top: 30px;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 10px;
            text-align: center;
            font-size: 12px;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .battle-status {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .vs-indicator {
                order: -1;
                width: 60px;
                height: 60px;
                font-size: 18px;
            }

            .nav-btn {
                display: block;
                margin: 10px auto;
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ü§ñ‚öîÔ∏èüë® HUMAN vs AI TRADING BATTLE</h1>
            <p>Can you beat the AI trading bot? Let the battle begin!</p>
        </div>

        <!-- Battle Status -->
        <div class="battle-status">
            <div class="competitor" id="humanCompetitor">
                <div class="competitor-title human-title">üë® HUMAN TRADER</div>
                <div class="balance-display" id="humanBalance">$10,000</div>
                <div class="pnl-display" id="humanPnl">$0 (0.0%)</div>
            </div>
            
            <div class="vs-indicator">VS</div>
            
            <div class="competitor" id="aiCompetitor">
                <div class="competitor-title ai-title">ü§ñ AI TRADING BOT</div>
                <div class="balance-display" id="aiBalance">$10,000</div>
                <div class="pnl-display" id="aiPnl">$0 (0.0%)</div>
            </div>
        </div>

        <!-- Battle Stats -->
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-value" id="humanTrades">0</div>
                <div class="stat-label">Human Trades</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="aiTrades">0</div>
                <div class="stat-label">AI Trades</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="humanWinRate">0%</div>
                <div class="stat-label">Human Win Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="aiWinRate">0%</div>
                <div class="stat-label">AI Win Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="battleTime">0:00</div>
                <div class="stat-label">Battle Duration</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="marketActivity">LOW</div>
                <div class="stat-label">Market Activity</div>
            </div>
        </div>

        <!-- Battle Controls -->
        <div class="battle-controls">
            <button class="battle-btn" onclick="startBattle()" id="startBtn">üöÄ START BATTLE</button>
            <button class="battle-btn" onclick="resetBattle()" id="resetBtn">üîÑ RESET BATTLE</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Chart Section -->
            <div class="chart-section">
                <div class="chart-header">
                    <select class="pair-select" id="pairSelect">
                        <option value="EURUSD">EUR/USD</option>
                        <option value="GBPUSD">GBP/USD</option>
                        <option value="USDJPY">USD/JPY</option>
                    </select>
                    <div style="display: flex; align-items: center;">
                        <div class="current-price" id="currentPrice">1.10450</div>
                        <div class="price-change" id="priceChange">+0.0000</div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart" id="chart">
                        <!-- Candlesticks will appear here -->
                    </div>
                    
                    <!-- Signal Indicator -->
                    <div id="chartSignal" class="signal-indicator" style="display: none;">
                        üéØ SIGNAL
                    </div>
                </div>

                <!-- Trading Signals -->
                <div class="signals-panel">
                    <h3 style="color: #60efff; margin-bottom: 8px; font-size: 14px;">üìä Trading Signals</h3>
                    
                    <div class="current-signal" id="mainSignal">
                        <div>
                            <div class="signal-type" id="signalType">NEUTRAL</div>
                            <div style="font-size: 10px; opacity: 0.8;" id="signalDesc">Analyzing market...</div>
                        </div>
                        <div class="signal-strength" id="signalStrength">--</div>
                    </div>
                </div>
            </div>

            <!-- Human Trading Panel -->
            <div class="trading-panel">
                <div class="panel-title">üë® Human Trader</div>
                
                <div class="form-group">
                    <label class="form-label">Position Size ($)</label>
                    <input type="number" class="form-input" id="positionSize" value="1000" min="100" max="5000" step="100">
                </div>
                <div class="form-group">
                    <label class="form-label">Stop Loss (pips)</label>
                    <input type="number" class="form-input" id="stopLoss" value="20" min="5" max="100">
                </div>
                <div class="form-group">
                    <label class="form-label">Take Profit (pips)</label>
                    <input type="number" class="form-input" id="takeProfit" value="30" min="5" max="100">
                </div>
                <div class="button-group">
                    <button class="btn btn-buy" onclick="humanTrade('BUY')">üìà BUY</button>
                    <button class="btn btn-sell" onclick="humanTrade('SELL')">üìâ SELL</button>
                </div>

                <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: #ff6b6b;">üìã Human Positions (<span id="humanPositionCount">0</span>)</div>
                <div class="positions" id="humanPositions">
                    <div style="text-align: center; opacity: 0.6; padding: 15px; font-size: 11px;">
                        No open positions
                    </div>
                </div>
            </div>

            <!-- AI Trading Panel -->
            <div class="trading-panel ai-panel">
                <div class="panel-title">ü§ñ AI Trading Bot</div>
                
                <!-- AI Status -->
                <div class="ai-status" id="aiStatus">
                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">üß† AI Status</div>
                    <div style="font-size: 10px;" id="aiStatusText">Waiting for battle to start...</div>
                </div>

                <div style="font-size: 11px; margin-bottom: 10px; padding: 8px; background: rgba(78, 205, 196, 0.1); border-radius: 6px;">
                    <div><strong>AI Strategy:</strong></div>
                    <div>‚Ä¢ Auto-follows signals ‚â•70% strength</div>
                    <div>‚Ä¢ Perfect discipline & timing</div>
                    <div>‚Ä¢ Adaptive position sizing</div>
                    <div>‚Ä¢ No emotions or hesitation</div>
                </div>

                <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: #4ecdc4;">üìã AI Positions (<span id="aiPositionCount">0</span>)</div>
                <div class="positions" id="aiPositions">
                    <div style="text-align: center; opacity: 0.6; padding: 15px; font-size: 11px;">
                        No open positions
                    </div>
                </div>

                <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: #4ecdc4;">üìä AI Actions</div>
                <div class="positions" id="aiTradeLog" style="max-height: 120px;">
                    <div style="text-align: center; opacity: 0.6; padding: 15px; font-size: 11px;">
                        AI activity will appear here
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation-buttons">
            <a href="https://ihoggan.github.io/ihoggan-portfolio/index.html" class="nav-btn" target="_blank">üè† HomePage</a>
            <a href="https://github.com/sponsors/ihoggan" class="nav-btn" target="_blank">‚ù§Ô∏è Support</a>
        </div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <h3 style="margin-bottom: 8px;">‚ö†Ô∏è Important Disclaimer</h3>
            <p>
                This is a <strong>simulation for educational purposes only</strong>. Neither the AI bot nor the signals represent real financial advice. 
                Real forex trading involves substantial risk. If you think this simulation means you can beat the markets with real money, 
                you're about to learn an expensive lesson. <strong>Don't quit your day job!</strong>
            </p>
        </div>
    </div>

    <script>
        // Simple game state
        let game = {
            started: false,
            startTime: null,
            currentPrice: 1.10450,
            previousPrice: 1.10450,
            prices: [],
            signals: [],
            human: {
                balance: 10000,
                startBalance: 10000,
                positions: [],
                trades: 0,
                wins: 0
            },
            ai: {
                balance: 10000,
                startBalance: 10000,
                positions: [],
                trades: 0,
                wins: 0,
                thinking: false
            }
        };

        // Generate simple price data
        function generatePrices() {
            game.prices = [];
            let price = 1.10450;
            
            for (let i = 0; i < 50; i++) {
                const change = (Math.random() - 0.5) * 0.002;
                const open = price;
                price += change;
                price = Math.max(1.08, Math.min(1.13, price));
                const close = price;
                
                const high = Math.max(open, close) + Math.random() * 0.0005;
                const low = Math.min(open, close) - Math.random() * 0.0005;
                
                game.prices.push({
                    open: parseFloat(open.toFixed(5)),
                    high: parseFloat(high.toFixed(5)),
                    low: parseFloat(low.toFixed(5)),
                    close: parseFloat(close.toFixed(5)),
                    isGreen: close >= open
                });
            }
            
            game.currentPrice = price;
            game.previousPrice = price;
        }

        // Generate simple signals
        function generateSignals() {
            game.signals = [];
            
            if (game.prices.length < 10) return;
            
            const recentPrices = game.prices.slice(-10).map(p => p.close);
            const avgPrice = recentPrices.reduce((sum, p) => sum + p, 0) / recentPrices.length;
            
            // Simple trend signals
            if (game.currentPrice > avgPrice * 1.002) {
                game.signals.push({
                    signal: 'BUY',
                    strength: 75,
                    description: 'Price above average - uptrend'
                });
            } else if (game.currentPrice < avgPrice * 0.998) {
                game.signals.push({
                    signal: 'SELL',
                    strength: 75,
                    description: 'Price below average - downtrend'
                });
            }
            
            // Random strong signals occasionally
            if (Math.random() < 0.1) {
                const direction = Math.random() > 0.5 ? 'BUY' : 'SELL';
                game.signals.push({
                    signal: direction,
                    strength: 85,
                    description: 'Strong momentum detected'
                });
            }
            
            game.signals.sort((a, b) => b.strength - a.strength);
            updateSignalsDisplay();
        }

        // Update chart
        function updateChart() {
            const chart = document.getElementById('chart');
            chart.innerHTML = '';
            
            if (game.prices.length === 0) return;
            
            const allPrices = game.prices.flatMap(candle => [candle.high, candle.low]);
            const maxPrice = Math.max(...allPrices);
            const minPrice = Math.min(...allPrices);
            const priceRange = maxPrice - minPrice;
            
            if (priceRange === 0) return;
            
            const chartWidth = chart.clientWidth || 600;
            const candleWidth = Math.max(4, (chartWidth - 40) / game.prices.length);
            
            game.prices.forEach((candle, i) => {
                const candleDiv = document.createElement('div');
                candleDiv.className = `candle ${candle.isGreen ? 'green' : 'red'}`;
                
                const bodyHeight = Math.max(Math.abs(candle.close - candle.open) / priceRange * 300, 2);
                const bottomPosition = (Math.min(candle.open, candle.close) - minPrice) / priceRange * 300;
                
                candleDiv.style.height = bodyHeight + 'px';
                candleDiv.style.bottom = bottomPosition + 'px';
                candleDiv.style.position = 'absolute';
                candleDiv.style.left = (i * (candleWidth + 1) + 10) + 'px';
                candleDiv.style.width = candleWidth + 'px';
                
                chart.appendChild(candleDiv);
            });
            
            updatePriceDisplay();
        }

        // Update price display
        function updatePriceDisplay() {
            document.getElementById('currentPrice').textContent = game.currentPrice.toFixed(5);
            
            const change = game.currentPrice - game.previousPrice;
            const changeElement = document.getElementById('priceChange');
            changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(5)}`;
            changeElement.className = `price-change ${change >= 0 ? 'price-up' : 'price-down'}`;
        }

        // Update signals display
        function updateSignalsDisplay() {
            const signalType = document.getElementById('signalType');
            const signalDesc = document.getElementById('signalDesc');
            const signalStrength = document.getElementById('signalStrength');
            const mainSignal = document.getElementById('mainSignal');
            const chartSignal = document.getElementById('chartSignal');
            
            if (game.signals.length === 0) {
                signalType.textContent = 'NEUTRAL';
                signalDesc.textContent = 'No clear signals detected';
                signalStrength.textContent = '--';
                mainSignal.style.background = 'rgba(96, 239, 255, 0.1)';
                chartSignal.style.display = 'none';
                return;
            }
            
            const topSignal = game.signals[0];
            signalType.textContent = topSignal.signal;
            signalDesc.textContent = topSignal.description;
            signalStrength.textContent = `${topSignal.strength}%`;
            
            if (topSignal.signal === 'BUY') {
                signalType.className = 'signal-type profit';
                mainSignal.style.background = 'rgba(0, 255, 135, 0.1)';
            } else {
                signalType.className = 'signal-type loss';
                mainSignal.style.background = 'rgba(255, 107, 107, 0.1)';
            }
            
            // Show chart signal for strong signals
            if (topSignal.strength >= 75) {
                chartSignal.style.display = 'block';
                chartSignal.textContent = `${topSignal.signal === 'BUY' ? 'üìà' : 'üìâ'} ${topSignal.signal} ${topSignal.strength}%`;
                chartSignal.className = `signal-indicator ${topSignal.signal === 'BUY' ? 'signal-buy' : 'signal-sell'}`;
                
                // AI considers trading
                if (game.started && topSignal.strength >= 75) {
                    aiConsiderTrade(topSignal);
                }
            } else {
                chartSignal.style.display = 'none';
            }
        }

        // AI trading logic
        function aiConsiderTrade(signal) {
            if (game.ai.thinking || !game.started) return;
            
            // AI won't overtrade
            if (game.ai.positions.length >= 2) return;
            
            game.ai.thinking = true;
            updateAIStatus('üß† Analyzing signal...');
            
            setTimeout(() => {
                const size = 1000;
                const stopLoss = 20;
                const takeProfit = 30;
                
                const success = executeTrade('ai', signal.signal, size, stopLoss, takeProfit);
                
                if (success) {
                    updateAIStatus(`‚úÖ ${signal.signal} trade executed`);
                    addToAILog(`${signal.signal} ${size} - ${signal.strength}%`);
                    showNotification(`ü§ñ AI executed ${signal.signal} trade`, 'ai');
                } else {
                    updateAIStatus('‚ùå Trade failed');
                }
                
                game.ai.thinking = false;
            }, 1000 + Math.random() * 2000);
        }

        // Execute trade for human or AI
        function executeTrade(trader, direction, size, stopLossPips, takeProfitPips) {
            const traderData = game[trader];
            
            if (size > traderData.balance) return false;
            
            const spread = 0.00015;
            const entryPrice = direction === 'BUY' ? 
                game.currentPrice + spread : 
                game.currentPrice - spread;
            
            const position = {
                id: Date.now() + Math.random(),
                direction: direction,
                size: size,
                entryPrice: entryPrice,
                stopLoss: direction === 'BUY' ? 
                    entryPrice - (stopLossPips * 0.0001) : 
                    entryPrice + (stopLossPips * 0.0001),
                takeProfit: direction === 'BUY' ? 
                    entryPrice + (takeProfitPips * 0.0001) : 
                    entryPrice - (takeProfitPips * 0.0001),
                pnl: 0,
                openTime: new Date()
            };
            
            traderData.positions.push(position);
            traderData.trades++;
            
            updatePositions(trader);
            updateBattleDisplay();
            
            return true;
        }

        // Human trade function
        function humanTrade(direction) {
            if (!game.started) {
                showNotification('Start the battle first!', 'error');
                return;
            }
            
            const size = parseFloat(document.getElementById('positionSize').value);
            const stopLoss = parseFloat(document.getElementById('stopLoss').value);
            const takeProfit = parseFloat(document.getElementById('takeProfit').value);
            
            const success = executeTrade('human', direction, size, stopLoss, takeProfit);
            if (success) {
                showNotification(`${direction} position opened!`, 'success');
            } else {
                showNotification('Trade failed!', 'error');
            }
        }

        // Update positions for trader
        function updatePositions(trader) {
            const container = document.getElementById(`${trader}Positions`);
            const countElement = document.getElementById(`${trader}PositionCount`);
            const traderData = game[trader];
            
            countElement.textContent = traderData.positions.length;
            
            if (traderData.positions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; opacity: 0.6; padding: 15px; font-size: 11px;">
                        No open positions
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            traderData.positions.forEach((pos, index) => {
                // Calculate P&L
                let currentPrice = game.currentPrice;
                if (pos.direction === 'BUY') {
                    currentPrice -= 0.00015;
                } else {
                    currentPrice += 0.00015;
                }
                
                let priceDiff;
                if (pos.direction === 'BUY') {
                    priceDiff = currentPrice - pos.entryPrice;
                } else {
                    priceDiff = pos.entryPrice - currentPrice;
                }
                pos.pnl = (priceDiff / 0.0001) * (pos.size / 1000);
                
                const duration = Math.floor((new Date() - pos.openTime) / 1000);
                const durationStr = duration < 60 ? `${duration}s` : `${Math.floor(duration/60)}m`;
                
                const posDiv = document.createElement('div');
                posDiv.className = 'position';
                posDiv.innerHTML = `
                    <div class="position-header">
                        <span style="font-size: 11px;">
                            ${pos.direction} ${pos.size} (${durationStr})
                        </span>
                        <span class="${pos.pnl >= 0 ? 'profit' : 'loss'}" style="font-size: 12px; font-weight: bold;">
                            ${pos.pnl >= 0 ? '+' : ''}${pos.pnl.toFixed(2)}
                        </span>
                    </div>
                    <div style="font-size: 10px; opacity: 0.8;">
                        Entry: ${pos.entryPrice.toFixed(5)} | SL: ${pos.stopLoss.toFixed(5)} | TP: ${pos.takeProfit.toFixed(5)}
                    </div>
                    ${trader === 'human' ? `<button class="close-btn" onclick="closePosition('${trader}', ${index})">‚úï Close</button>` : ''}
                `;
                container.appendChild(posDiv);
            });
        }

        // Check all positions for SL/TP
        function checkPositions() {
            ['human', 'ai'].forEach(trader => {
                const traderData = game[trader];
                traderData.positions.forEach((pos, index) => {
                    let shouldClose = false;
                    let reason = '';
                    
                    let closePrice = game.currentPrice;
                    if (pos.direction === 'BUY') {
                        closePrice -= 0.00015;
                        if (closePrice <= pos.stopLoss) {
                            shouldClose = true;
                            reason = 'Stop Loss Hit';
                        } else if (closePrice >= pos.takeProfit) {
                            shouldClose = true;
                            reason = 'Take Profit Hit';
                        }
                    } else {
                        closePrice += 0.00015;
                        if (closePrice >= pos.stopLoss) {
                            shouldClose = true;
                            reason = 'Stop Loss Hit';
                        } else if (closePrice <= pos.takeProfit) {
                            shouldClose = true;
                            reason = 'Take Profit Hit';
                        }
                    }
                    
                    if (shouldClose) {
                        closePosition(trader, index, reason);
                    }
                });
            });
        }

        // Close position
        function closePosition(trader, index, reason = 'Manual Close') {
            const traderData = game[trader];
            const pos = traderData.positions[index];
            
            traderData.balance += pos.pnl;
            
            if (pos.pnl > 0) {
                traderData.wins++;
            }
            
            traderData.positions.splice(index, 1);
            
            const traderEmoji = trader === 'human' ? 'üë®' : 'ü§ñ';
            const message = `${traderEmoji} ${reason}: ${pos.pnl >= 0 ? '+' : ''}${pos.pnl.toFixed(2)}`;
            
            showNotification(message, trader === 'ai' ? 'ai' : (pos.pnl >= 0 ? 'success' : 'error'));
            
            if (trader === 'ai') {
                addToAILog(`CLOSED: ${pos.pnl >= 0 ? '+' : ''}${pos.pnl.toFixed(2)} (${reason})`);
                updateAIStatus(`${reason} - ${pos.pnl >= 0 ? 'Profit' : 'Loss'}: ${pos.pnl.toFixed(2)}`);
            }
            
            updatePositions(trader);
            updateBattleDisplay();
        }

        // Update AI status
        function updateAIStatus(statusText) {
            document.getElementById('aiStatusText').textContent = statusText;
            const statusDiv = document.getElementById('aiStatus');
            if (game.ai.thinking) {
                statusDiv.classList.add('ai-thinking');
            } else {
                statusDiv.classList.remove('ai-thinking');
            }
        }

        // Add to AI log
        function addToAILog(logEntry) {
            const logDiv = document.getElementById('aiTradeLog');
            const entryDiv = document.createElement('div');
            entryDiv.style.fontSize = '10px';
            entryDiv.style.padding = '4px 8px';
            entryDiv.style.background = 'rgba(78, 205, 196, 0.1)';
            entryDiv.style.borderRadius = '4px';
            entryDiv.style.marginBottom = '4px';
            
            const timeStr = new Date().toLocaleTimeString('en-US', {
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit'
            });
            entryDiv.textContent = `${timeStr}: ${logEntry}`;
            
            if (logDiv.children.length === 1 && logDiv.children[0].textContent.includes('activity will appear')) {
                logDiv.innerHTML = '';
            }
            
            logDiv.insertBefore(entryDiv, logDiv.firstChild);
            
            // Keep only last 5 entries
            while (logDiv.children.length > 5) {
                logDiv.removeChild(logDiv.lastChild);
            }
        }

        // Update battle display
        function updateBattleDisplay() {
            // Update balances
            document.getElementById('humanBalance').textContent = `${game.human.balance.toFixed(0)}`;
            document.getElementById('aiBalance').textContent = `${game.ai.balance.toFixed(0)}`;
            
            // Update P&L
            const humanPnl = game.human.balance - game.human.startBalance;
            const aiPnl = game.ai.balance - game.ai.startBalance;
            
            const humanPnlPercent = (humanPnl / game.human.startBalance * 100);
            const aiPnlPercent = (aiPnl / game.ai.startBalance * 100);
            
            document.getElementById('humanPnl').textContent = `${humanPnl >= 0 ? '+' : ''}${humanPnl.toFixed(0)} (${humanPnlPercent >= 0 ? '+' : ''}${humanPnlPercent.toFixed(1)}%)`;
            document.getElementById('aiPnl').textContent = `${aiPnl >= 0 ? '+' : ''}${aiPnl.toFixed(0)} (${aiPnlPercent >= 0 ? '+' : ''}${aiPnlPercent.toFixed(1)}%)`;
            
            // Update competitor styling
            const humanComp = document.getElementById('humanCompetitor');
            const aiComp = document.getElementById('aiCompetitor');
            
            humanComp.className = 'competitor';
            aiComp.className = 'competitor';
            
            if (humanPnl > aiPnl) {
                humanComp.classList.add('winning');
                aiComp.classList.add('losing');
            } else if (aiPnl > humanPnl) {
                aiComp.classList.add('winning');
                humanComp.classList.add('losing');
            }
            
            // Update stats
            document.getElementById('humanTrades').textContent = game.human.trades;
            document.getElementById('aiTrades').textContent = game.ai.trades;
            
            const humanWinRate = game.human.trades > 0 ? (game.human.wins / game.human.trades * 100) : 0;
            const aiWinRate = game.ai.trades > 0 ? (game.ai.wins / game.ai.trades * 100) : 0;
            
            document.getElementById('humanWinRate').textContent = `${humanWinRate.toFixed(0)}%`;
            document.getElementById('aiWinRate').textContent = `${aiWinRate.toFixed(0)}%`;
            
            // Update battle time
            if (game.started && game.startTime) {
                const elapsed = Math.floor((Date.now() - game.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('battleTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Start battle
        function startBattle() {
            if (game.started) {
                showNotification('Battle already in progress!', 'error');
                return;
            }
            
            game.started = true;
            game.startTime = Date.now();
            
            document.getElementById('startBtn').textContent = '‚öîÔ∏è BATTLE IN PROGRESS';
            document.getElementById('startBtn').disabled = true;
            
            updateAIStatus('üöÄ Battle started - AI ready!');
            
            showNotification('‚öîÔ∏è BATTLE STARTED! May the best trader win!', 'success');
            setTimeout(() => {
                showNotification('ü§ñ AI is now actively trading on strong signals!', 'ai');
            }, 2000);
            
            startSimulation();
        }

        // Reset battle
        function resetBattle() {
            if (confirm('Reset the battle? This will clear all positions and reset balances.')) {
                // Reset game state
                game.started = false;
                game.startTime = null;
                
                // Reset traders
                ['human', 'ai'].forEach(trader => {
                    game[trader].balance = 10000;
                    game[trader].startBalance = 10000;
                    game[trader].positions = [];
                    game[trader].trades = 0;
                    game[trader].wins = 0;
                });
                
                game.ai.thinking = false;
                
                // Reset UI
                document.getElementById('startBtn').textContent = 'üöÄ START BATTLE';
                document.getElementById('startBtn').disabled = false;
                
                updateAIStatus('Waiting for battle to start...');
                document.getElementById('aiTradeLog').innerHTML = `
                    <div style="text-align: center; opacity: 0.6; padding: 15px; font-size: 11px;">
                        AI activity will appear here
                    </div>
                `;
                
                updatePositions('human');
                updatePositions('ai');
                updateBattleDisplay();
                
                showNotification('Battle reset! Ready for a new challenge!', 'success');
            }
        }

        // Show notification
        function showNotification(message, type) {
            // Remove existing notifications of the same type
            document.querySelectorAll(`.notification.${type}`).forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 300);
                }
            }, 4000);
        }

        // Start simulation
        function startSimulation() {
            if (game.isRunning) return;
            game.isRunning = true;
            
            setInterval(() => {
                // Update price
                const change = (Math.random() - 0.5) * 0.0005;
                game.previousPrice = game.currentPrice;
                game.currentPrice += change;
                game.currentPrice = Math.max(1.08, Math.min(1.13, game.currentPrice));
                
                // Add new candlestick occasionally
                if (Math.random() < 0.3) {
                    const lastCandle = game.prices[game.prices.length - 1];
                    const open = lastCandle ? lastCandle.close : game.currentPrice;
                    const close = game.currentPrice;
                    
                    const volatility = 0.0003;
                    const high = Math.max(open, close) + Math.random() * volatility;
                    const low = Math.min(open, close) - Math.random() * volatility;
                    
                    const newCandle = {
                        open: parseFloat(open.toFixed(5)),
                        high: parseFloat(high.toFixed(5)),
                        low: parseFloat(low.toFixed(5)),
                        close: parseFloat(close.toFixed(5)),
                        isGreen: close >= open
                    };
                    
                    game.prices.push(newCandle);
                    if (game.prices.length > 50) game.prices.shift();
                    
                    updateChart();
                    generateSignals();
                }
                
                updatePriceDisplay();
                checkPositions();
                updatePositions('human');
                updatePositions('ai');
                updateBattleDisplay();
            }, 2000);
        }

        // Initialize
        function init() {
            console.log('Initializing Human vs AI Trading Battle...');
            generatePrices();
            updateChart();
            updateBattleDisplay();
            
            setTimeout(() => {
                showNotification('‚öîÔ∏è Welcome to Human vs AI Trading Battle!', 'success');
            }, 1000);
            
            setTimeout(() => {
                showNotification('üöÄ Click START BATTLE to begin!', 'success');
            }, 3000);
            
            console.log('Battle arena ready!');
        }

        // Start when page loads
        window.addEventListener('load', () => {
            setTimeout(init, 500);
        });
    </script>
</body>
</html>
